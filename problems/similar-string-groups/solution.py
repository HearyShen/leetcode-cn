import time
from typing import List
from collections import defaultdict


class Solution:
    def __init__(self):
        self.similarDict = defaultdict(set)
        self.isSimilarCaches = defaultdict()

    def numSimilarGroups(self, A: List[str]) -> int:
        """Returns the count of similar string groups."""
        # BUG: 2020.3.4, failed, not fast enough
        words = set(A)
        self.buildSimilarDict(A, len(A), len(A[0]))

        groupCount = 0
        while words:
            groupWords = set()
            bfsQueue = [words.pop()]
            while bfsQueue:
                curWord = bfsQueue[0]
                similarWords = self.similarDict[curWord].intersection(words)
                if similarWords:
                    bfsQueue.extend(similarWords)
                    words = words - similarWords
                # basic BFS operation
                groupWords.add(curWord)
                bfsQueue.remove(curWord)
            if groupWords:
                # print(groupWords)
                groupCount += 1
        return groupCount

    def buildSimilarDict(self, words: set, wordsCount:int, wordLen:int):
        print(f"WordsCount={wordsCount}, WordLen={wordLen}")
        if wordsCount > wordLen * 2:
            print('Choose all possible swap method.')
            findSimilarWords = self.findSimilarWordsA   # O(N * W^2)
        else:
            print('Choose traverse words method.')
            findSimilarWords = self.findSimilarWordsB   # O(N^2 * W)
        
        for word in words:
            # similarDict: size(len(words), len(word))
            self.similarDict[word] = findSimilarWords(word, words)

    def findSimilarWordsA(self, word: str, words: set) -> set:
        """
        Return all similar words of a word. 
        All possible swaps. O(W^2)
        """
        similarWords = set()
        for i in range(len(word)):
            similarWordsOfI = set([word[:i] + word[j] + word[i + 1:j] + word[i] + word[j + 1:] for j in range(i + 1, len(word))])  # replace i, j
            similarWords = similarWords.union(similarWordsOfI)
        similarWords.intersection_update(words)
        return similarWords

    def findSimilarWordsB(self, curWord: str, words: set) -> set:
        """
        Return all similar words of a word. 
        All similar in words. O(NW)
        """
        similarWords = set([word for word in words if self.isSimilar(curWord, word)])
        return similarWords

    def isSimilar(self, wordA, wordB):
        """Returns if two words is similar(2 chars swapped). O(W)"""
        if len(wordA) != len(wordB):
            return False
        
        try:
            cachedIsSimilar = self.isSimilarCaches[(wordA, wordB)]
        except KeyError:
            diffChars = [[wordA[i], wordB[i]] for i in range(len(wordA)) if wordA[i] != wordB[i]]
            if len(diffChars) == 2 and diffChars[0][0] == diffChars[1][1] and diffChars[0][1] == diffChars[1][0]:
                self.isSimilarCaches[(wordB, wordA)] = True
                return True
            self.isSimilarCaches[(wordB, wordA)] = False    # cache isSimilar result
            return False
        else:
            return cachedIsSimilar


if __name__ == "__main__":
    # A = ["tars", "rats", "arts", "star"]
    A = ["xyjznvnbxxuglvqmqqxyctfrnaaakgucdsuismxwxauehfccrlaxnivfxjbnswueibsjmktwvlflgzukpyvzeoltefbdwjtximof","abcfvwaomwgfafnjumzeauhfrawxtccesklyzfdngxqnymtxvkuvdxeqlllbuxnlsxfxigevmupurjyxnbzkbiwtiqvocxisjtjs","fateesekbkdovxujlcoxwtfpizxzdtbgmwwevnusyqhymwnzalsfcurkmcaxvgtsgxijnmfbniqucnyfiqjfxxlbalxurjvxluav","maedsefoxhcflvamyvxpbbnnjxibwwwnvtflztcgnjisxvfqztizcxeutlyirryneqduxgfmxqxaagxskuslcbwovjljufuaukkm","xceejbatfnmwgehivqabtdxdswxlmfiyrcsavnuwmovobjtylfxvsuccmzyuxrqxwzukebgquazgsinifpulknlatfvfxljkxnjx","fcvjguebtkiakxitmmlxvcnnahcxeuigvrwajpyfuqcoefnwfizlqxdsalnsvuojgqyxrxzmfbfxbjtlvzxtlnxskawusweyubmd","bcyvzvifnnxgtmlhgylficebzxadwsrubvalosnjjolnuvldjtckqpkqxckuxuwifrjzwaebfsuauxfneaqmgmivstwtyxxexmxf","eyqnqibofjwfxdzanjgxxcdlxrtcnelwlfgvxnxfkwvqucsmpfbxxzokztysvmxmvalgeniucmufbvujiyitbjteaasauwurhksl","nfmunywcbcxiaksejxtudmlawbkljnvdqqbvcpqzfaeunsxfzefmxkogxxnirtjuslfwyshxlvuavirwluigafomyvxtxgbcjzte","ixfemqlxjbsunaftxxptmxfivwcgjancnoubzwjsealyzrkudyetxvxtaivlfsjvolemwgnciqklxkwuacduvfuszmynfbrqhxbg","ixfemqlxjbsunaftxxptmxfivwcjgancnoubzwjsealyzrkudyetxvxtaivlfsjvolemwgnciqklxkwuxcduvfuszmynfbrqhabg","xqsovkmkgqzlxgujuoujxxgcujiufnxnwyfixxcxvaknfbrstenhbfmyfipuctijbvbelvwwaamnldqcevarfydlzesmtwltxazs","ygnkbflxvsmavfrlsznxjgixbtqauxlmcncznwmxfdtfuuebrduqywxaliuetlxehpajxzgskaonffesvivjvqywtmoicbkjwxuc","limsatwebxzfamsgjvgwujbrfliwvwszndhfxbsameyngmkjjtukqeexlxxvctxucqaytvoicffyilfqprxxnxuuzbuodvcnknla","anxmubhyjtswvllkvqcwpxsuuaamfrenejqvijeftxdjioodugxnwiexllzmbgxzfwtvufslracigbkycmvxxzfntnbckuaqsfxy","eyqnqibofjwfxdzanjgxxcdlxntcnxlwlfgnxrxfkuvqucsmpfbexzokvtysvmxmvalemviucgufbzwjiyitbjteaasauwurhksl","zpuxhxxvbcnyfxvlrwsncyljxwfbnxeulmigigsadixdfajxlmaoewmsbnqavvarmqtjengfktsxfktkujqfzbieouwcutylzvcu","sxwsqjaslglxznulnhednkikuygiflwmndfjabcxyqxzcxuyowcegttuftpuxvmxelxvtrffmsvaeivqxbjjmbwvuznkrifbaaco","uefginlfxtncrswtrlukfxkvjdziavtimulxsuajbwcfxaxstjeynoigyjeofmucgzbmvcbzhxeamvsbwlxqqxalqnxuvdpkywfn","cmnnewbxbjxsyfuwqwburlcljvjvuxfadllxbmuxvdkehafzpxgyofixnusizegnnimxowtcizvejasgfftqvcklrtkauaqysmtx","eyqnqibofjwfxdzanjgxxcdlxrtcnelwlfgvxnxfkwvqucsmpfbxxzokvtysvmxmvalgeniucmufbzujiyitbjteaasauwurhksl","juekxxxmcjnatfdaensqnzxvsfzciywfmeczrtbaiqxknvxauuirwwmbsvvoyxelfgjuunpdfklgwgfmjuibhsxxactlvlyqtblo","xilusvumiqklxntzycxtbrxgxtxxeqabqlntwlbjfsdvslamxfzwjswvkeudpwyvuainffuicjxugoeervnoamcnfbzamgkhfcyj","vaalfiwxfxyijcfyxozbmjmynewgkmqcjrluocucfxemetukeftarkvvxptxsdjsunuwnbqzbxilgvaxqidnlsfaubvxlsthgnzw","bbslfvktauwmxwkfravuqgubnayuwlclovdmncjxebyvxfiiwqimvjczzaxcxnftxhousqsjejpkurxfggtextiflenxmynazsdl","fateesesbkdovxujlcxxwtfpiznzdtbgmwwevxusyqhymwnzalsxcurkmcaxvgtkgfijnmfbniqucnyfiqjfoxlbalxurjvxluav","vzsfmaktrnbunxncmwfncyxxxgwxelyxvlfjlvxdhfeavltbkptuoswljkyutmudiwivnusfrcszjcfqqebmaxaigjugqzixaobe","eyqnqibofjwfxdzanjgxxcdlxrtcnelwlfgnxnxfkwvqucsmpfbxxzokvtysvmxmvalgeviucmufbzujiyitbjteaasauwurhksl","bbslfvktauwmxtkfravuqgubnayuwlclovdmncjxebyvxfiiwqimvjczzaxcxnftxhousqsjejpkurxfggtexwiflenxmynazsdl","maedsefoxhcflvamyvxpbbnnjxibwwwnktflztcgnjisxvfqztizcxeutlyirryneqduxgfmxqxaagxsvuslcbwovjljufuaukkm","limsatwebxzfamsgjedwujbrfliwvwsznjhfxbsamvyngmkjgtukreexlxxvctxucqaytvoicffyilfqpqxxnxuuzbuodvcnknla","limsatwebxzfamsgjvgwujbrfliwvwszndhfxbsameyngmkjjtukreexlxxvctxucqaytvoicffyilfqpqxxnxuuzbuodvcnknla","hytjacsnjavzuvenpjziamswkfxslmtvuxdxfbllfkqxztxwtvfxfieubuxckexcxwnaulgqfjosgreloinmbrvicybmuqgwaynd","axfvnqutsulxxevmymqiorrejbyflbbzclzjxcphjmvamdfteikaklcxnuqgwswlgftfxvncxgxswubauvwnfoxjitaznsuekiyd","nfmunywcbcxiaksejxtudmlawbkljnvdqqbvcpqzfaeunsxfzefmxkogxxnirtjuslfwysvxlvuavirwluigafomyhxtxgbcjzte","eyqnqibofjwfxdzanjgxxcdlxntcnxlwlfgnxrxfkuvqucsmpfbexzokvtysvmxmvalgeviucmufbzwjiyitbjteaasauwurhksl","fateesesbkdovxujlcxxwtfpiznzdtbgmwwevxusyqhymwnzalsfcurkmcaxvgtkgxijnmfbniqucnyfiqjfoxlbalxurjvxluav","uefginlfxtncrswtrlukfxkvjdziavtimulxsuajbwcfxavstjeynoigyjeofmucgzbmvcbzhxeamxsbwlxqqxalqnxukdpvywfn","azfwxpxfnumlxeilflgaucbvnisxtyxdrueqdokejzzhtentbikbfmxafrsvyqmxlwxulbmvngsuknajtvfqccajcsiwowyuxgvj","bvyjfbevteysdnilmiujgxclskmfacualfndeuxaonyumqzmsfzkstvptnabwhgcwconxiwlaxlfixxvrzvtufqjxxweburjqkgx","xylngbtvhlfdnbcixwzurumkxuseqyojxkmmyvbxrtniejcadipafnbnlzxvwcfiueuxxasjwsxqoukgjvmglawltvfcffzsateq","snivfkaytceiwyvsxaucsefmxqxvlwzavnqvbggfmilmkucxfyanhrzotmaxucwzquellujwnbiufnjxrdgjbetosxbtpjfkxdxl","wqbxupwuigkvjsxqntsnutkuffmzcoexanxbtjmujlbaamuzevwddnfsoykhxffrxxybilvixlljitvreegnzcwgqmaxcvcfaysl","axfvnqutsulixevmymqxorrejbyflxbzclzjxcphjmvamdfteikaklcxnuqgwswlgftfxvncbgxswubauvwnfoxjitaznsuekiyd","ufmoebnnnwmejwyrnlaydokfpcbawstnfazisajtvvcaklvmjhqxuxzsgzsbixxutcxrmqgyxdvfgifxcbkulfeltxlivjuewuqx","udkrxufzqqlbjdirjsnggufxgmnmeeoqetwxelwnltvyancalaotuxjnuxcyxfbvfhbvcvuxkkpzwajiwzlbcisxxsyftasmvimf","jymkogxixawszxtyltubfbctlesxuejdnqucdvqmhnplnengjvaxsxixkkivyblugwmuzrfvvsfcnfxblajaoqerwxwfuzctfima","lblktwffdqgvuwbxamaxnjjtyycecqwfnvxyolxisfauodalsmgtbwlputzzcqsrusnjhzuxigifvexmkavixrufbcemnkxexnjv","wmzlsafhamicsujdlyucftgwxtymxcxflknlusxuibxlieeeoxgokqdvxnjatafrfwbxzmxjnvjeivuctvpknwsqvangzbfyuqrb","bcyvzvifnnxgtmlhgylficebzxadwsrubvalosnjjolnuvldjtckqpkqfckuxuwixrjzwaebfsuauxfneaqmgmivstwtyxxexmxf","sxwsqjaslglxznulnhednkikuygiflwmndfjabcxyqxzcxuyowcegttuftpuxvmxelxvtrvfmsvreifqxbjjmbwvuznkaifbaaco","limsatwebxzfamsgjedwujbrflxwvwsznjhfxbsamvyngmkjgtukreexlxxvctxucqaytvoicffyilfqpqxinxuuzbuodvcnknla","fateesesbkdovxujlcxxwtfpiznzdtbgmwwlvxusyqhymwnzaesxcurkmcaxvgtkgfijnmfbniqucnyfiqjfoxlbalxurjvxluav","eyqnqibofjwfxdzanjgxxcdlxrtcnelwlfgnxnxfkuvqucsmpfbxxzokvtysvmxmvalgeviucmufbzwjiyitbjteaasauwurhksl","erxkffaixwunlcjxiaytsixwxfdrsjuxqmwuvogexlnpbmbtakgaxqlsvmnalcwvuxtkhyvuujozitzgynebfcnqmezbffvlcjsd","sxwsqjaslglxznulnhednkikuygiflwmncfjabcxyqxzcxuyowcegttuftpuxvmxelxvtrffmsvaeivqxbjjmbwvuznkrifbaado","gzmddautazxjnlsmckjbzuevwwbyewfsflvtiwgvufcyunocxlbvxsarpixjiyxtcfneqxxbsfrtmkagnkexulmhnuqofjaxlqvi","uefginlfxtncrswtrlukfxkvjdziavtimulxsuajbwcfxavstjeynoigyjeofmucgzbmvcbzhxeamxsbwlxqqxalqnxuvdpkywfn","gsxgvmamzxaxyuuqwnafskkynxvitclfstwzmfqcecjgsmvixjlbveetjodnrpxbvuetyaowuxbbxcfzfdinkhufllrlaqniwjxu","hytjacsnjavzuvekpjziamswkfxslmtvuxdxfbllfkqxztxwtvfxfieubuxcnexcxwnaulgqfjosgreloinmbrvicybmuqgwaynd","anxmubhyjttwvllkvqcwpxsuuaamfrenejqvijeftxdjioodugxnwiexllzmbgxzfwtvufslracigbkycmvxxzfnsnbckuaqsfxy","wnjllbveqljfesbhwjcawmtfnlydkisvzaeaqymlfvaxxxnrxxvykmfiosjkduigntwtxuzmxutvixgsqegrcocpnubxbfufacuz","cdpkfxcfqcuqgjhnifnfaxjzlagvxalmuuzkgwaxsbkvtnbtexfscwowmsivvmofuxrnlredwbixayuxqettzlyilmyvnsjuebjx","eyqnqibofjwfxdzanjgxxcdlxntcnelwlfgnxrxfkuvqucsmpfbxxzokvtysvmxmvalgeviucmufbzwjiyitbjteaasauwurhksl","xrblbxcswqjxdzjaooxzytycgrumycxbhjextvukeuunvueicfamflslwlawxfgqxubgfnisiqmnfxafpkajnznivtsekdmltvvw","gsxgvmamzxaxyuuqwnafskkynxvitclfstwlmfqcecjgsmvixjlbveetjodnrpxbvuetyaowuxbbxcfzfdinkhufllrzaqniwjxu","anxmubhyjttwvllkvqcwpxsuuaamfrenejqvijeftxdjioodugxnviexllzmbgxzfwtwufslracigbkycmvxxzfnsnbckuaqsfxy","hrtjocsnjavzuvekpjziamswkfxslbtvuxdxfbllfkqxztxwtvfxfieumuxcnexcxwnaulgqfjosgyelainmbrvicybmuqgwaynd","tfzddmsbxlnivrjnckvxgbmtoaupqccxifeaekxhiyxylqucbuwrxvetyjnmwxensoukwxuvwfixajatngslqglasumfbzzflfjv","cuncthkivwxaseuloeectzdpufmquxlfztfafsgfgafnnogrjdqelvkvmvlxuyiynwavxjwnyjmkxzuctxmwqbbbjixlibrsxxas","wdfcxxuwgclflgxipunnjzvtwmlaeiniarsvkuowoszejbcbkqffffyuutcyxqslvxvajjtnabdqermsvntzxhxmxgbauykixelm","scatqezuxzsaitqtvzmngxnqviygkknvknlxbaviocxfmxuofwfbuwnyefbcdurhabvsmltxamfsxxurgpcdewwxlujlyjjfjeil","zpuxhxxvbcnyfxvlrwsncyljxwfbnxeulmigfgsadixdiajxlmaoewmsbnqavvarmqtjengfktsxfktkujqfzbieouwcutylzvcu","kfqbtjvfflmjcukkieeugsylxdmaltfvxnczrxbvcjjrxumfcxbuoewwyuxetiahgonbllwxyznwxavqaisgpduqnvasmisfntzx","nbllkdxypuxsxjcvtrlwfxvxxjtsgawqtbeifyyqqvaxmwaukklibomusxntuvrhojemfzalzewcmivgfnijacfbenxfucunzdgs","kbcfvwaomwgfafnjumzeauhfrawxtccesklyzfdngxqnymtxvauvdxeqlllbuxnlsxfxigevmupurjyxnbzkbiwtiqvocxisjtjs","rgimwfliufmtvxvkhxalcmbxlbjwbftkjkauaafwlbuezenzvgxeisgntoyauudnnjerczifsxdvxyvxtxuwjpfnslcmoxqcqyqs","xixusvumiqklxntzycltbrxgxtxxeqabqlntwlbjfsdvslamxfzwjswvkeudpwyvuainffuicjxugoeervnoamcnfbzamgkhfcyj","bbslfvktacwmxtkfravuugubnayuwlulovdmncjxebyxxfiiwqimvjczzaxcxnftvohusdsjejpkqrxfggtexwnflenxmyiazsql","weumiknfzntbmdjoegyvnceagpdxttsqxcfxfeztbfnbxvkvrmblfvksxcyualrivwjquizgacuxmsuxxiuxjlhfslylowwqajan","sxwsqjaslglxznulnhednkikuygiflwmndfjabcxyqxzcxuyowcegttuftpuxvmxelxvtrffmsvreivqxbjjmbwvuznkaifbaaco","iemqnonflnwjutzvyoadejsubtjixcxifbaxwftqsqjxcvxyxdkxylvssgxpczvruvhluwagimemmelnuawgfckxlnfrabbzkftu","svjnjssupwnyqxgcaljuxsurmbvcnyizlbkwglywotxgnxedkettvaizqjeoavwlfzuutmfcxbmxilafxffxidavuqcbxkfhnerm","wdfcxxuwgclflgxipunnjzvtkmlaeiniarsvwuowoszejbcbkqffffyuutcyxqslvxvajjtnabdqermsvntzxhxmxgbauykixelm","bbslfvktauwmxtkfravuqgubnayuwlclovdmncjxebyxxfiiwqimvjczzaxcxnftvhousqsjejpkurxfggtexwiflenxmynazsdl","tcmauyxzuonvbzwcuqkqfeewmtuhiaksdsfktfxiaeloyrcwjjubginlvjjiqxvgcxyrtxxagmlmnwvufbnffsxdbneaxllxzpvs","gvnxzfmyczatcexsnxhbazlemunkuivfsuwtnlxanqfykljxdgvrsjaiilexbffytoibwvcqvxwgmujtqusrdfcmaxbkojpewlux","nfoqzwfsvdstsgawaueomucnxjbxuemufxbyqchrxagfmbiekxtlmyvljtkfuqrcuzsyvixvvexwjpjnzgtwxliaxcdalknfblin","cmnnewbxbjxsyfuwqwburlcljvjvuxfadllxbmuxvdkehafzpxgyofixnusizegnnimxortcizvejasgfftqvcklwtkauaqysmtx","xceejbaffnmwgehivqabtdxdswxlmfiyrcsavnuwmovobjtylfxvsuccmzyuxrqxwzukebgquazgsinifpulknlatfvtxljkxnjx","limsatwebxzfamsgjvgwujbrfliwvwszndhfxbsameyngmkjjtukqeexlxxvctxucqaylvoicffyitfqprxxnxuuzbuodvcnknla","xydngbtvhlfdnbcixwzurumkxuseqyojxkmmyvbxrtniejcalipafnbnlzxvwcfiueuxxasjwsxqoukgjvmglawltvfcffzsateq","yannfciifgiztboxuxulujljwvbpsqxgmcocjazaxhwfuqmvsybysjkfeueremfktlwzaxkgtqtsblcnmivvwvexrnxdafudxlxn","vcwuxgaudeknyopsifrnnuwubxvefyzsyjfgtxmciawxzxmzuuxdqeiekcnjxbsrkamhswqovlfibtflfaagtjlmjxltlcnbqxvv","zpuxhxxvbcnyfxvlrwsncyljxwfbnxeulmigfgsadxxdiajilmaoewmsbnuavvarmqtjengfktsxfktkqjqfzbieouwcutylzvcu","xyjznvnbxxuglvqmyqxqctfrnaaakgucdsuismxwxauehfccrlaxnivfxjbnswueibsjmktwvlflgzukpyvzeoltefbdwjtximof","gzmddautacxjnlsmzkjbzuevwwbyewfsflvtiwgvufcyunocxlbvxsarpixjiyxtcfneqxxbsfrtmkagnkexulmhnuqofjaxlqvi","acbcjpqyjnynkbyireazzfldcwavxmnexmubtjxoxfwxwlzgkfsadiixmffrtxsueolswuniulubuqctegfanhjvkvsvqlxtmvxg","qutgbiokcaeclfrlxkxinwpexfujoeckywvnxsgusdjcbjtlxbufwxzmaxizuwubllegvnvafnatqyirymmndafsfjtxsxqhvmvz","tzexrdrjkfiesqxxjkicbovllfujfcwnoavnxbifwiutvnumvtwdgaxucmegybuxpymqxflntsalxnjxvbekzglszwchaqsyfuma","twzefnavjyxoxjkmsplxcaiwfrdzvldxbebhcgufrmzujanjfibuutlqyclsfuxaxxmkwbgxyivmnclseosivnatukfwtqgvxqen","zlavxkzxtnnecvjflbfifqcpsxvrwijbugsnttogvaioulmvmwajrkbqqujgsxzyffecxmxduxeuuhmdtnclinylfkwxybaasexw","bbslfvktacwmxtkfravuugubnayuwlulovdmncjxebyxxfiiwqimvjczzaxcxnftvohusqsjejpkqrxfggtexwiflenxmynazsdl","wmisogspbeeyqfbaxasctlvxuvfleghktjnfitirxdxxzzrunoamkdcmfawcjmtwnbxellyfqiqswbufgunyuxazvvcuvxknxjjl","wrvcoytxdenjghjzybosniakevxxvufivtuufacwesqjfwrsstbxlmiuyluitxcxgmnzfmelbvaxfdpqnwbfjlaxxlckqzgnmuak","ixfemqlxjbsunaftxxptmxfivwcjgancnoubzwjsealyzrkudyetxvxtaivlfsjvwlemwgnciqklxkouxcduvfuszmynfbrqhabg","limsatwebxzfamsgjegwujbrfliwvwsznjhfxbsamvyngmkjdtukreexlxxvctxucqaytvoicffyilfqpqxxnxuuzbuodvcnknla","psnylxgqxjvymcadfnyawflurqiosgdxxelobxkvwvvuwbftrckxaulhezsqgnxmsebiuxmtfjultfwcatnbeuzjikvijnczxamf","skxwxcatufvyxafsjrxesuyonbggxanvetlauubuszxlzwetvxmxfmwbjyflfwqifxvcegdjamukqzbpvoiqncincjrkltinlhdm","zpuxhxxvbcnyfxvlrwsncyljxwfbnxeulmigfgsadixdiajxlmaoewmsbnuavvarmqtjengfktsxfktkqjqfzbieouwcutylzvcu","uvwwxghcmlmuzkvnjbgxbpxeyinfnbyaelffudlxxaouaemwstctuiqfqisdxsltanjevlazmwqvcutvixjzckyrgnxjosxkffrb","vcwuxgaudeknyopsifrnnuwubxvefyzsyjfgtxmciawvzxmzuuxdqeiekcnjxbsrkamhswqovlfibtflfaagtjlmjxltlcnbqxxv","dxnrpfevkawfrldxvnxzawvlxkximkxmeysxxbbfhutlcmuqyqtggbnjyozisunfgovcjutlxiawsfzujutvsnabcqlemjfiewca","ufxoebnnnwmejwyrnlaydokfpcbawstnfazisajtvvcaklvmjhqxuxzsgzsbixxutcmrmqgyxdvfgifxcbkulfeltxlivjuewuqx","fdgftwajvksvotwxbfetpsyfgeczaaclhqubzgumnuxmdwsrxnksvllcjvryojxmutbixmxqxjlnfqvwynaczenkuxuileiiafxb","hrtjacsnjavzuvekpjziamswkfxslmtvuxdxfbllfkqxztxwtvfxfieubuxcnexcxwnaulgqfjosgyeloinmbrvicybmuqgwaynd","yrfvjaxxxukfbfgtsxbmlekmxfpduuefnxzufvvjitlzlmxqwsclieayhqcavaoqvmcwnbbyjuzsiidkcowslgjretnanuwtxnxg","cdpkfxcfqcuqgjhnifnfaxjzlagvxalmuuzkgwaxsbkvtnbtexfscwowmsivvmofuxrnlreswbixayuxqettzlyilmyvndjuebjx","wnjlltveqljfesbhwjcawmtfnlydkisvzaeaqymlfvaxxxnrxxvykmfiosjkduigntwtxuzmxubvixgsqegrcocpnubxbfufacuz","bbslfvktacwmxtkfravuqgubnayuwlulovdmncjxebyxxfiiwqimvjczzaxcxnftvohusqsjejpkurxfggtexwiflenxmynazsdl","bbslfvktauwmxtkfravuqgubnayuwlclovdmncjxebyxxfiiwqimvjczzaxcxnftvohusqsjejpkurxfggtexwiflenxmynazsdl","jvbmyxjtfitngccfbakfsmrlseajzwepxsfvuurwyfiivcucmwkmlqqnattvnsyauagxxzbqxllnkeoixvxnegulzxhdwofjubdx","znzlzvukwayfxaswkpnbaivxjftrctcxeqxqgqnnltrxnybwufijeglocwuljuxsaoxffdvmveyhiusmmbxaukstmvfijxeldbgc","wrvgoytxdenjghjzybosniakevxxvufivtuufacwesqjfwrsstbxlmiuyluitxcxgmnzfmelbvaxfdpqnwbfjlaxxlckqzcnmuak","xrblbxcswqjxdzjaooxzytycgrumycxbhjextvukeuunvueicfalflslwlawxfgqxubgfnisiqmnfxafpkajnznivtsekdmmtvvw","bbslfvktauwmxwkfravuqzubnmyuwlclovdmncjxebyvxfiiwqimvjcgzaxcxnftxhousqsjejpkurxfggtextiflenxaynazsdl","ixfemqlxjbsunaftxxptmxfivwcjgancnoubzwjsealyzrkudyetxvxtaivlfsjvwlemwgnciqklxmouxcduvfuszkynfbrqhabg","lsmwiddgoffjbfffaaxbntxvxeaxlusqcrgevacbwxsmnreubvupvuwhuklxzxcqfynmoywnjavtkmjixqczngutiljkyxlzseti","tcmauyxzuonvbzwcuqkqfeewmtuhiaksdsfktfxiaeloylcwjjubginrvjjiqxvgcxyrtxxagmlmnwvufbnffsxdbneaxllxzpvs","gsxgvmamzxaxyuuqznafskrynxvitclfstwwmfqcecjgsmvixjlbveetjodnrpxbvuetyaowuxbbxcfzfdinkhufllklaqniwjxu","twzefnavjygoxjkmsplxcaiwfrdzvldxbebhcgufrmzujanjfibuutlqyclsfuxaxxmkwbxxyivmnclseosivnatukfwtqgvxqen","xfqxljymbxnnwoawvwfshafdblffcjczilmgvxuebxrmnxxkxejvcoiusyaglmartujxekeviwdintsskzcgqfvutuzpbnutalyq","zpuxhxxvacnyfxvlrwsncyljxwfbnxeulmigigsadixdfajxlmaoewmsbnqavvbrmqtjengfktsxfktkujqfzbieouwcutylzvcu","muxuakptfczsgmqxdhxxnxfnzsnwevgflqaxlgyovwoyjzdbltmuamuauvbtxafrjfjwixcnqflxeybvrsecwicnkksljiutvbie","xydngbtvhlfdnbcixwzurumkxuseqyojxkmmyvbxrtniejcalipaznbnlfxvwcfiueuxxasjwsxqoukgjvmglawltvfcffzsateq","hrtjacsnjavzuvekpjziamswkfxslbtvuxdxfbllfkqxztxwtvfxfieumuxcnexcxwnaulgqfjosgyeloinmbrvicybmuqgwaynd","lqtmykmjxewfxuvzbxinpoinjqcwjlfjnazfurdirhttsxmwsxsubfzckgeytmxvaildnnxykvlqosgvbgfleubxeawvauaccuxf","axfvnqutsulxxevmymqiorrejbyflxbzclzjxcphjmvamdfteikaklcxnuqgwswlgftfxvncbgxswubauvwnfoxjitaznsuekiyd","nbllkdjypuxsxjcvtrlwfxvxxjtsgawqtbeifyyqqvaxmwaukklibomusxntuvrhojemfzalzewcmivgfnixacfbenxfucunzdgs","zlavxkzxtnnecvjflbfifqcpsxvrwijbugsnttogvaioulmvmwajrkbqqujisxzyffecxmxduxeuuhmdtnclgnylfkwxybaasexw","klxwmfjeuxexpnnruflathygbyzsabxbgsvxfmquiltnvdyqolazaslzviouatgcixxeuiuqfrvnwcfcbkjwkwmjcsdnxfvextmj","lafnnibyxbxajwmldntjwuualncxuyorxciqejubekuvgxqvpmsduishfabckjiqstzeysoxxfwaxzngwvcefgtrvlffvlkxzmmt","aefvfzvbmatifwidnbwywjutgcgirucqunlskexmfxxxhgkxymnyotlcqnfqzsrzkvxalmsjdebxwvilbjevtauofxaplucnujsx","iwuufecbalamxctdseqntishnlakawxtlvvxsizcovcogpujuqjxkylamxwevbujkfmniftbsvfdrlnwxxrjnyxybfezxzgmgufq","cdpkfxcfqcuqgjhnifnfaxjzlagvlalmuuzkgwaxsbkvtnbtexfscwowmsivvmofuxrnlreswbixayuxqettzxyilmyvndjuebjx","yannfdiifgiztboxuxulujljwvbpsqxgmcocjazaxhwfuqmvsybysjkfeueremfktlwzaxkgtqtsblcnmivvwvexrnxdafucxlxn","xfgxljymbxnnwoawvwfshafdblffcjczilmqvxuebxrmnxxkxejvcoiusyaglmartujxekeviwdintsskzcgqfvutuzpbnutalyq","xylngbtfhlfdnbcixwzurumkxuseqyojxkmmyvbxrtniejcadipavnbnlzzvwcfiueuxxasjwsxqoukgjvmglawltvfcffxsateq","xwqviymfjhliocbblfnxtxqxzlqxxesbanfcfesmujtnwuocglwrvpcmknvyxedakuwdxiaalrbjmsnaztziyfvjxfsuvugkuget","eyqnqibofjwfxdzanjgxxcdlxntcnxlwlfgnxrxfkuvqucsmpfbexzokvtysvmxmvalgmviuceufbzwjiyitbjteaasauwurhksl","ixfemqlxjbsunaftxxptmxfivwcjgancnoubzwjsealyzrkudyetxvxtaivlfsjvolemwgnciqklxkwuacduvfuszmynfbrqhxbg","svjnjssupwnyqxgcaljuxsurmbvcnyizlbkwglywotxgxxedkettvaizqjeoavwlfzuutmfcnbmxilafxffxidavuqcbxkfhnerm","uceejbaffnmwgehivqabtdxdswxlmfiyrcsavnuwmovobjtylfxvsuccmzyuxrqxwzukebgquazgsinifpxlknlatfvtxljkxnjx","xvejcsjykweojxpsokuxmfsiwnxbauivcfzfakftyxvzwtflagsbrvxgbzxqlnvqmxllwuylcruuduexngabiatqhndmmiecftnj","xylngbtvhlfdnbcixwzurumkxuseqyojxkmmyvbxrtniejcadipafnbnlzzvwcfiueuxxasjwsxqoukgjvmglawltvfcffxsateq","wnjlltveqljfesbhwjcawmtfnlydkisvzaeaqymlfvaxxfnrxxvykmxiosjkduigntwtxuzmxubvixgsqegrcocpnubxbfufacuz","xqsovkmkgqzlxgfjuoujxxgcujiuunxnwyfixxcxvaknfbrstenhbfmyfipuctijbvbelvwwaamnldqcevarfydlzesmtwltxazs","limsatwebxzfamsgjvgwujbrfliwvwsznjhfxbsameyngmkjdtukreexlxxvctxucqaytvoicffyilfqpqxxnxuuzbuodvcnknla","aytxemxxfsxmvnxnowsmvncdtfucfkyudtilslgzcypeejiaxqbfbbvvgxblorjcwxuuunqnifrzaltjvwkksizqlmeuwjagxfah","yetamfjilvxuzekkkjluowqaijwfgmtblfvgdhncaqaritljxydnwxgfszcssnuoexpxnmbtialyuvmxffcecubvxbvxuwsxqrzn","fcvjgugbtkiakxitmmlxvcnnahcxeuigvrwajpyfuqcoefnwfizlqxdsalnsvuojeqyxrxzmfbfxbjtlvzxtlnxskawusweyubmd","bbslfvktacwmxtkfravuugubnayuwlulovdlncjxebyxxfiiwqimvjczzaxcxnftvohusdsjejpkqrxfggtexwnflenxmyiazsqm","wmisogupbeeyqfbaxasctlvxuvfleghktjnfitirxdxxzzrsnoamkdcmfawcjmtwnbxellyfqiqswbufgunyuxazvvcuvxknxjjl","axfvnqutsulixevmymqxorrejbyflxbzclzjxcphjmvamdfteikaklcxnuqgwswlgftfxvncbgxswubauvwtfoxjinaznsuekiyd","maedsefoxhcflvamyvxpbbnnjxibwwwnvtflztcgnjisbvfqztizcxeutlyirryneqduxgfmxqxaagxskuulcxwovjljufsaukkm","txvllxxfvegefcgtfxaaxcyhrunfnlbuuzxjaszwnsejfyxqbrvozluetskljwipidsvamgcwawbvimxkufnumbxicqntdkojymq","maedsefoxhcflvamyvxpbbnnjxibwwwnvtflztcgnjisbvfqztizcxeutlyirryneqduxgfmxqxaagxskuslcxwovjljufuaukkm","txvllxxfvegefcgtfxaaxcyrrunfnlbuuzxjaszwnsejfyxqbhvozluetskljwipidsvamgcwawbvimxkufnumbxicqntdkojymq","vcwuxgaudeknyopsifrnnuwubxvefyzsyjfgtxmciawvzxmzuuxdqecekcnjxbsrkamhswqovlfibtflfaagtjlmjxltlinbqxxv","gsxgvmamzxaxyuuqwnafskkynxvitclfstwmlfqcecjgsmvixjlbveetjodnrpxbvuetyaowuxbbxcfzfdinkhufllrzaqniwjxu","fateesesbkdovxujlcoxwtfpiznzdtbgmwwevxusyqhymwnzalsfcurkmcaxvgtkgxijnmfbniqucnyfiqjfxxlbalxurjvxluav","hbuqlnvuxuocvzrsflijzfjulzwtglcjxxtsnrxnfskyqvivnfpxibdtcnaejsyekgegxaukawwatdvfmwlxxxcyemuqiobfmmba","ubvxvjmyvuikxvxgulxunefzjtgldsezxxypicxywkbaxatnuuwdfcotchwvqltnmwqfabaalgfszlmkrijsjoqbrffxmecesnni","udkrxufzqqlbjdirjsnggufxgmnmyeoqetwxelwnltveancalaotuxjnuxcyxfbvfhbvcvuxkkpzwajiwzlbcisxxsyftasmvimf","lafnncbyxbxajwmldntjwuualncxuyorxiiqejubekuvgxqvpmsduishfabckjiqstzeysoxxfwaxzngwvcefgtrvlffvlkxzmmt","uikrqnclsvozrwpvdfwxbgxffseytujsxnsywcixglucymfaeltvkxljixbnbejqldxgaankvuoaqxufezaztmmfcjthmvwniubx","bbslfvktacwmxtkfravuugubnayuwlulovdmncjxebyxxfiiwqimvjczzaxcxnftvohusqsjejpkqrxfggtexwnflenxmyiazsdl","cbutgwaxwjojiaddsxugtwkoiqvfuvbxkctbvltfenxmlxhkisxawyeafaflcmrzvxenxymmjbyxscfuqvljznnsgpnelifuurzq","bbslfvktauwmxwkfravuqgubnmyuwlclovdmncjxebyvxfiiwqimvjczzaxcxnftxhousqsjejpkurxfggtextiflenxaynazsdl","wmisogspbeeyqfbaxasctlvxuvfleghktjnqitirxdxxzzrunoamkdcmfawcjmtwnbxellyffiqswbufgunyuxazvvcuvxknxjjl","lgfknnijfixtjzoimsyvsqfltubnmnlbkhsauryilovvexdznxggwbemkauxjacelqzumwdtxcbsfcvfxqyweuatcxpxrwvjfaux","aefvfzvbmatifwidnbwywjutgcgirucqunlskexmfxxxhgkxymnyotlcqnfqzsrzkvxalmsjdebxwvilbjextauofxaplucnujsv","sjxsctmbvljgthixlsxbilwyjkfinmkkccebcltsagjbxgreowpmqmudaffnvqxxleyuefiuzyatxdrxunxvvanoqzuaunfwfwzv","iwuufecbalamxctdsexntishnlakawxtlvvxsizcovcogpujuqjqkylamxwevbujkfmniftbsvfdrlnwxxrjnyxybfezxzgmgufq","tcmauyxztonvbzwcuqkqfeewmuuhiaksdsfktfxiaeloyrcwjjubginlvjjiqxvgcxyrtxxagmlmnwvufbnffsxdbneaxllxzpvs","yetamfjilvxuzekkkjluowqaijwfgmtblfvgdhncaqaritljxydnwxgfszcssnuoexpxnmbtialyuvmxfvcecubvxbfxuwsxqrzn","dxnrpfevkawfrldxvnxzawvlxkximkvmeysxxbbfhutlcmuqyqtggbnjyozisunfgovcjutlxiawsfzujutxsnabcqlemjfiewca","uesaxzrxljwvrmsafeivgnvxjfptvlnctnxmlxzucuzqkxmefeaiuukwsjxaqadxygtdkinqblbycjnoctwhwbmfiglffxsbvyou","fateesesbkdovxujlcoxwtfpizxzdtbgmwwevnusyqhymwnzalsfcurkmcaxvgtkgxijnmfbniqucnyfiqjfxxlbalxurjvxluav","gsxgvmamzxaxyuuqwnafskrynxvitclfstwzmfqcecjgsmvixjlbveetjodnrpxbvuetyaowuxbbxcfzfdinkhufllklaqniwjxu","zlavxkzxtnnecvjflbfifvcpsxvrwijbugsnttogqaioulmvmwajrkbqqujisxzyffecxmxduxeuuhmdtnclgnylfkwxybaasexw","ygnkbflxvsmavfrlsznxjgixbtqauxlmcncznwmxfdtfuuebrduqywxaliuetlxehpojxzgskaonffesvivjvqywtmaicbkjwxuc","erlbmfxfgeimjfavsrcvwfozxllcuanjbwvmnitaufkkalxoxasuefyjqdgnqnzygzqmsuxxbuntvevhstipxcjwxcwtidlxykub","gwtcyuoaxxlqfljfuuwgstnbmxzqihovylriwndkvbexcbyafcsnivfqfwxajfbnummumaezepgislrxcvjavexlzsjtukdxknxt","vaalfiwxfxyilcfyxozbmjmynewgkmqcjrluocucfxemetukeftarkvvxptxsdjsunuwnbqzbxilgvaxqidnjsfaubvxlsthgnzw"]

    tic = time.time()
    ret = Solution().numSimilarGroups(A)
    toc = time.time()

    print(f"Found {ret} similar groups in {toc-tic:.3f}s.")